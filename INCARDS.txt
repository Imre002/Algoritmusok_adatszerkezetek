A televíziózás korában nem sokan járnak színházi előadásokra. A malidnéziai antik komikusok tisztában vannak ezzel a ténnyel. A színházat és legfőképpen az antik vígjátékokat akarják propagálni. Nyomtatott meghívóval rendelkeznek minden szükséges információval és a programmal. Nagyon sok diákot béreltek fel, hogy ezeket a meghívókat szétosszák az emberek között. Minden önkéntes tanuló pontosan egy buszmegállót jelölt ki, és ott marad egész nap, és meghívja a buszon utazókat. Egy speciális kurzuson tanultak a diákok, hogyan lehet befolyásolni az embereket, és mi a különbség a befolyásolás és a rablás között.

A közlekedési rendszer nagyon különleges: minden vonal egyirányú, és pontosan két megállót köt össze. A kiinduló megállóhelyről a buszok félóránként indulnak utasokkal. A célállomás elérése után üresen térnek vissza a kiinduló megállóba, ahol várnak a következő teljes fél óráig, pl. X:00 vagy X:30, ahol az „X” az órát jelöli. A két megálló közötti szállítás díját külön asztalok adják, és a helyszínen fizetendő. A vonalak úgy vannak megtervezve, hogy minden oda-vissza út (azaz az utazás ugyanabban a megállóban kezdődik és végződik) áthaladjon egy központi ellenőrzőpont megállón (CCS), ahol minden utasnak alapos, testvizsgálatot is tartalmazó ellenőrzésen kell átmennie.

Az ACM összes hallgatója minden reggel elhagyja a CCS-t. Minden önkéntesnek egy előre meghatározott megállóhelyre kell mennie, hogy meghívja az utasokat. Annyi önkéntes van, ahány megáll. A nap végén minden diák visszautazik a CCS-be. Olyan számítógépes programot kell írnia, amely segít az ACM-nek minimalizálni az alkalmazottak szállításáért naponta fizetendő pénzt.

Bemenet
A bemenet N esetből áll. A bemenet első sora csak N pozitív egész számot tartalmaz. Ezután kövesse az eseteket. Minden eset pontosan két P és Q egész számot tartalmazó sorral kezdődik, 1 <= P,Q <= 1000000. P a megállók száma, beleértve a CCS-t és Q a buszvonalak száma. Aztán vannak Q sorok, amelyek mindegyike egy buszvonalat ír le. Mindegyik sor pontosan három számot tartalmaz – a kiinduló megállóhelyet, a célállomást és az árat. A CCS-t az 1-es szám jelöli. Az árak pozitív egész számok, amelyek összege kisebb, mint 1000000000. Azt is feltételezhetjük, hogy mindig el lehet jutni bármelyik megállóból bármely másik megállóba.

Kimenet
Minden esethez nyomtasson egy sort, amely tartalmazza az ACM által naponta fizetendő minimális összeget önkéntesei utazási költségeire.